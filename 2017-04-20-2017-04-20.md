# 2017-04-20

## TODO

- write wiki about sbj trouble, using s3 or perl
- manual of replacing nginx ecs
- aws summit review
- terraform apply
- 


## manual of replacing nginx ecs

- checkout nginx settings
  - nginx.conf
  - list_saiyom.conf
  - conf under upstream
- checkout ecs settings
  - ecs-json : update.json > deploymentConfiguration > maximumPercent/minimumHealtyPercent
  - terraform : aws_ecs_service > deployment_maximum_percent/deployment_minimum_healthy_percent
- ecr
  - `make ecr PROJ= ENV= MODULE=reverse-proxy DOCKERFILE=Dockerfile`
- ecs
  - `make ecs PROJ= ENV= MODULE=reverse-proxy`

## command

- rewrite git history (rm secret files)
  - via 
    - http://qiita.com/go_astrayer/items/6e39d3ab16ae8094496c
    - http://qiita.com/wnoguchi/items/62f5e64ef2ae14b4f0ee
```

# remove 
git filter-branch --tree-filter "rm -f [/path/to/file]" HEAD
git filter-branch --tree-filter "rm -f -r [/path/to/directory] " HEAD

# gc
git gc --aggressive --prune=now

# push
git push -f

```

- nginx gzip on
  - via 
    - http://qiita.com/cubicdaiya/items/2763ba2240476ab1d9dd
```
gzip on;
# add Content-Type with `gzip_types` directive, cause `gzip on` directive only compress text/html
gzip_types text/css text/javascript;
```
